<Window x:Class="_3DObjectViewer.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:h="http://helix-toolkit.org/wpf"
        xmlns:controls="clr-namespace:_3DObjectViewer.Views.Controls"
        mc:Ignorable="d"
        Title="3D Object Viewer" Height="750" Width="1200">
    
    <!--
    ============================================================================
    MAIN WINDOW LAYOUT
    ============================================================================
    
    This window provides a 3D object viewing and manipulation environment.
    
    LAYOUT STRUCTURE:
    ┌─────────────┬────────────────────────────┬─────────────┐
    │   Left      │                            │   Right     │
    │   Panel     │     3D Viewport            │   Panel     │
    │   (220px)   │     (flexible)             │   (220px)   │
    │             │                            │             │
    │   Object    │   - Camera controls        │   Lighting  │
    │   Controls  │   - Ground plane           │   Controls  │
    │             │   - Grid overlay           │             │
    │             │   - Coordinate system      │             │
    └─────────────┴────────────────────────────┴─────────────┘
    
    INTERACTION:
    - Left-click: Select objects in the viewport
    - Ctrl+Left-click+Drag: Move selected object
    - Mouse wheel: Zoom camera
    - Right-click+Drag: Rotate camera
    - Middle-click+Drag: Pan camera
    
    COORDINATE SYSTEM:
    - X-axis: Red (horizontal, left-right)
    - Y-axis: Green (horizontal, front-back)  
    - Z-axis: Blue (vertical, up-down)
    - Ground plane is at Z=0
    ============================================================================
    -->
    
    <Grid>
        <!-- 
        THREE-COLUMN LAYOUT:
        Column 0: Left control panel for object management (fixed 220px)
        Column 1: Main 3D viewport (flexible, takes remaining space)
        Column 2: Right control panel for lighting (fixed 220px)
        -->
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="220"/>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="220"/>
        </Grid.ColumnDefinitions>

        <!--
        ========================================================================
        LEFT CONTROL PANEL - OBJECT MANAGEMENT
        ========================================================================
        Contains controls for:
        - Adding new 3D primitives (cube, sphere, cylinder, cone, torus)
        - Setting object properties (size, color, drop height)
        - Physics controls (gravity, enable/disable simulation)
        - Scene management (clear all, reset camera)
        
        DataContext: Inherits from parent (MainViewModel or SceneViewModel)
        ========================================================================
        -->
        <controls:ObjectControlPanel Grid.Column="0" DataContext="{Binding}"/>

        <!--
        ========================================================================
        3D VIEWPORT CONTAINER
        ========================================================================
        Wraps the viewport to allow overlay elements like the FPS counter.
        ========================================================================
        -->
        <Grid Grid.Column="1">
            <h:HelixViewport3D x:Name="HelixViewport"
                               Background="LightGray"
                               ShowCoordinateSystem="True"
                               ZoomExtentsWhenLoaded="True"
                               MouseDown="HelixViewport_MouseDown"
                               MouseMove="HelixViewport_MouseMove"
                               MouseUp="HelixViewport_MouseUp">
                
                <!-- ...existing Camera, AmbientLight, RectangleVisual3D, GridLinesVisual3D... -->
                <h:HelixViewport3D.Camera>
                    <PerspectiveCamera Position="10,10,10" 
                                       LookDirection="-10,-10,-10" 
                                       UpDirection="0,0,1" 
                                       FieldOfView="45"/>
                </h:HelixViewport3D.Camera>

                <ModelVisual3D x:Name="AmbientLightVisual">
                    <ModelVisual3D.Content>
                        <AmbientLight Color="#404040"/>
                    </ModelVisual3D.Content>
                </ModelVisual3D>
                
                <h:RectangleVisual3D Width="20" Length="20" 
                                      Origin="0,0,0"
                                      Normal="0,0,1"
                                      LengthDirection="1,0,0">
                    <h:RectangleVisual3D.Material>
                        <DiffuseMaterial>
                            <DiffuseMaterial.Brush>
                                <SolidColorBrush Color="#E8E8E8"/>
                            </DiffuseMaterial.Brush>
                        </DiffuseMaterial>
                    </h:RectangleVisual3D.Material>
                    <h:RectangleVisual3D.BackMaterial>
                        <DiffuseMaterial>
                            <DiffuseMaterial.Brush>
                                <SolidColorBrush Color="#E8E8E8"/>
                            </DiffuseMaterial.Brush>
                        </DiffuseMaterial>
                    </h:RectangleVisual3D.BackMaterial>
                </h:RectangleVisual3D>
                
                <h:GridLinesVisual3D Width="20" Length="20" 
                                      MajorDistance="2" 
                                      MinorDistance="1" 
                                      Thickness="0.02" 
                                      Center="0,0,0.01"/>

                <!-- 
                Bucket Walls (4m height, matching grid dimensions)
                Using RectangleVisual3D for each wall face
                Grid is 20x20, centered at origin, so walls are at X=±10, Y=±10
                Wall height is 4m, starting from Z=0 to Z=4
                
                RectangleVisual3D properties:
                - Origin: CENTER of the rectangle
                - Width: extends perpendicular to Normal and LengthDirection  
                - Length: extends along LengthDirection
                - Normal: direction the rectangle faces
                - LengthDirection: direction of the Length dimension
                -->
                
                <!-- Front wall (Y = +10) - vertical wall facing -Y -->
                <h:RectangleVisual3D Width="20" Length="4" 
                                      Origin="0,10,2"
                                      Normal="0,-1,0"
                                      LengthDirection="0,0,1">
                    <h:RectangleVisual3D.Material>
                        <DiffuseMaterial>
                            <DiffuseMaterial.Brush>
                                <SolidColorBrush Color="#60A0A0A0"/>
                            </DiffuseMaterial.Brush>
                        </DiffuseMaterial>
                    </h:RectangleVisual3D.Material>
                    <h:RectangleVisual3D.BackMaterial>
                        <DiffuseMaterial>
                            <DiffuseMaterial.Brush>
                                <SolidColorBrush Color="#60A0A0A0"/>
                            </DiffuseMaterial.Brush>
                        </DiffuseMaterial>
                    </h:RectangleVisual3D.BackMaterial>
                </h:RectangleVisual3D>
                
                <!-- Back wall (Y = -10) - vertical wall facing +Y -->
                <h:RectangleVisual3D Width="20" Length="4" 
                                      Origin="0,-10,2"
                                      Normal="0,1,0"
                                      LengthDirection="0,0,1">
                    <h:RectangleVisual3D.Material>
                        <DiffuseMaterial>
                            <DiffuseMaterial.Brush>
                                <SolidColorBrush Color="#60A0A0A0"/>
                            </DiffuseMaterial.Brush>
                        </DiffuseMaterial>
                    </h:RectangleVisual3D.Material>
                    <h:RectangleVisual3D.BackMaterial>
                        <DiffuseMaterial>
                            <DiffuseMaterial.Brush>
                                <SolidColorBrush Color="#60A0A0A0"/>
                            </DiffuseMaterial.Brush>
                        </DiffuseMaterial>
                    </h:RectangleVisual3D.BackMaterial>
                </h:RectangleVisual3D>
                
                <!-- Right wall (X = +10) - vertical wall facing -X -->
                <h:RectangleVisual3D Width="20" Length="4" 
                                      Origin="10,0,2"
                                      Normal="-1,0,0"
                                      LengthDirection="0,0,1">
                    <h:RectangleVisual3D.Material>
                        <DiffuseMaterial>
                            <DiffuseMaterial.Brush>
                                <SolidColorBrush Color="#60A0A0A0"/>
                            </DiffuseMaterial.Brush>
                        </DiffuseMaterial>
                    </h:RectangleVisual3D.Material>
                    <h:RectangleVisual3D.BackMaterial>
                        <DiffuseMaterial>
                            <DiffuseMaterial.Brush>
                                <SolidColorBrush Color="#60A0A0A0"/>
                            </DiffuseMaterial.Brush>
                        </DiffuseMaterial>
                    </h:RectangleVisual3D.BackMaterial>
                </h:RectangleVisual3D>
                
                <!-- Left wall (X = -10) - vertical wall facing +X -->
                <h:RectangleVisual3D Width="20" Length="4" 
                                      Origin="-10,0,2"
                                      Normal="1,0,0"
                                      LengthDirection="0,0,1">
                    <h:RectangleVisual3D.Material>
                        <DiffuseMaterial>
                            <DiffuseMaterial.Brush>
                                <SolidColorBrush Color="#60A0A0A0"/>
                            </DiffuseMaterial.Brush>
                        </DiffuseMaterial>
                    </h:RectangleVisual3D.Material>
                    <h:RectangleVisual3D.BackMaterial>
                        <DiffuseMaterial>
                            <DiffuseMaterial.Brush>
                                <SolidColorBrush Color="#60A0A0A0"/>
                            </DiffuseMaterial.Brush>
                        </DiffuseMaterial>
                    </h:RectangleVisual3D.BackMaterial>
                </h:RectangleVisual3D>

            </h:HelixViewport3D>

            <!--
            ====================================================================
            PERFORMANCE STATS OVERLAY
            ====================================================================
            Displays rendering and scene statistics in the top-left corner.
            Bound to PerformanceStatsViewModel for MVVM compliance.
            ====================================================================
            -->
            <Border Background="#80000000" 
                    CornerRadius="4" 
                    Padding="8"
                    HorizontalAlignment="Left"
                    VerticalAlignment="Top"
                    Margin="10"
                    DataContext="{Binding PerformanceStats}">
                <StackPanel>
                    <!-- FPS -->
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="FPS: " Foreground="#80FFFFFF" FontSize="14" FontWeight="Bold"/>
                        <TextBlock Text="{Binding FpsText}" Foreground="#00FF00" FontSize="14" FontWeight="Bold"/>
                    </StackPanel>
                    
                    <!--
                    ============================================================
                    FPS GRAPH
                    ============================================================
                    Live graph showing FPS over time.
                    - X-axis: Time (last ~30 seconds)
                    - Y-axis: FPS (0-120 range)
                    ============================================================
                    -->
                    <Grid Width="150" Height="40" Margin="0,5,0,0">
                        <!-- Graph background grid lines -->
                        <Canvas>
                            <Line X1="0" Y1="0" X2="150" Y2="0" Stroke="#40FFFFFF" StrokeThickness="0.5"/>
                            <Line X1="0" Y1="20" X2="150" Y2="20" Stroke="#40FFFFFF" StrokeThickness="0.5"/>
                            <Line X1="0" Y1="40" X2="150" Y2="40" Stroke="#40FFFFFF" StrokeThickness="0.5"/>
                        </Canvas>
                        
                        <!-- FPS line graph -->
                        <Canvas ClipToBounds="True">
                            <Polyline Points="{Binding FpsGraphPoints}"
                                      Stroke="#00FF00"
                                      StrokeThickness="1.5"
                                      StrokeLineJoin="Round"/>
                        </Canvas>
                        
                        <!-- Y-axis labels -->
                        <TextBlock Text="120" Foreground="#80FFFFFF" FontSize="8" 
                                   HorizontalAlignment="Left" VerticalAlignment="Top"/>
                        <TextBlock Text="0" Foreground="#80FFFFFF" FontSize="8" 
                                   HorizontalAlignment="Left" VerticalAlignment="Bottom"/>
                    </Grid>
                    
                    <!-- Separator -->
                    <Rectangle Height="1" Fill="#40FFFFFF" Margin="0,8,0,6"/>
                    
                    <!-- Frame Time -->
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="Frame Time: " Foreground="#80FFFFFF" FontSize="11"/>
                        <TextBlock Text="{Binding FrameTimeText}" Foreground="White" FontSize="11" FontWeight="SemiBold"/>
                    </StackPanel>
                    
                    <!-- Object Count -->
                    <StackPanel Orientation="Horizontal" Margin="0,3,0,0">
                        <TextBlock Text="Objects: " Foreground="#80FFFFFF" FontSize="11"/>
                        <TextBlock Text="{Binding ObjectCountText}" Foreground="White" FontSize="11" FontWeight="SemiBold"/>
                    </StackPanel>
                    
                    <!-- Triangle Count -->
                    <StackPanel Orientation="Horizontal" Margin="0,3,0,0">
                        <TextBlock Text="Triangles: " Foreground="#80FFFFFF" FontSize="11"/>
                        <TextBlock Text="{Binding TriangleCountText}" Foreground="White" FontSize="11" FontWeight="SemiBold"/>
                    </StackPanel>
                    
                    <!-- Physics Bodies -->
                    <StackPanel Orientation="Horizontal" Margin="0,3,0,0">
                        <TextBlock Text="Physics Bodies: " Foreground="#80FFFFFF" FontSize="11"/>
                        <TextBlock Text="{Binding PhysicsBodiesText}" Foreground="White" FontSize="11" FontWeight="SemiBold"/>
                    </StackPanel>
                    
                    <!-- Separator -->
                    <Rectangle Height="1" Fill="#40FFFFFF" Margin="0,6,0,6"/>
                    
                    <!-- Memory Usage -->
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="Memory: " Foreground="#80FFFFFF" FontSize="11"/>
                        <TextBlock Text="{Binding MemoryUsageText}" Foreground="#FF9900" FontSize="11" FontWeight="SemiBold"/>
                    </StackPanel>
                    
                    <!--
                    ============================================================
                    MEMORY GRAPH
                    ============================================================
                    Live graph showing memory usage over time.
                    - X-axis: Time (last ~30 seconds)
                    - Y-axis: Memory (0-500 MB range)
                    ============================================================
                    -->
                    <Grid Width="150" Height="40" Margin="0,5,0,0">
                        <!-- Graph background grid lines -->
                        <Canvas>
                            <Line X1="0" Y1="0" X2="150" Y2="0" Stroke="#40FFFFFF" StrokeThickness="0.5"/>
                            <Line X1="0" Y1="20" X2="150" Y2="20" Stroke="#40FFFFFF" StrokeThickness="0.5"/>
                            <Line X1="0" Y1="40" X2="150" Y2="40" Stroke="#40FFFFFF" StrokeThickness="0.5"/>
                        </Canvas>
                        
                        <!-- Memory line graph -->
                        <Canvas ClipToBounds="True">
                            <Polyline Points="{Binding MemoryGraphPoints}"
                                      Stroke="#FF9900"
                                      StrokeThickness="1.5"
                                      StrokeLineJoin="Round"/>
                        </Canvas>
                        
                        <!-- Y-axis labels -->
                        <TextBlock Text="500" Foreground="#80FFFFFF" FontSize="8" 
                                   HorizontalAlignment="Left" VerticalAlignment="Top"/>
                        <TextBlock Text="0" Foreground="#80FFFFFF" FontSize="8" 
                                   HorizontalAlignment="Left" VerticalAlignment="Bottom"/>
                    </Grid>
                    
                    <!-- Separator -->
                    <Rectangle Height="1" Fill="#40FFFFFF" Margin="0,6,0,6"/>
                    
                    <!-- Camera Position -->
                    <TextBlock Text="Camera Position" Foreground="#80FFFFFF" FontSize="10"/>
                    <TextBlock Text="{Binding CameraPositionText}" Foreground="White" FontSize="10" Margin="0,2,0,0"/>
                </StackPanel>
            </Border>
        </Grid>

        <!--
        ========================================================================
        RIGHT CONTROL PANEL - LIGHTING MANAGEMENT
        ========================================================================
        Contains controls for:
        - Adding/removing light sources
        - Adjusting light position (X, Y, Z coordinates)
        - Setting light direction (for directional lights)
        - Modifying light color and intensity
        - Managing multiple light sources in the scene
        
        DataContext: Inherits from parent (MainViewModel.Lighting)
        ========================================================================
        -->
        <controls:LightingControlPanel Grid.Column="2" DataContext="{Binding}"/>
    </Grid>
</Window>
